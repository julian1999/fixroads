<!DOCTYPE html>

<html>
  <head>
  
    <meta name="viewport" content="initial-scale=1.0, width=device-width" />

    <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.1/mapsjs-ui.css" />
    <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-core.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-service.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-ui.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-mapevents.js"></script>

    <script>

    function initGeolocation(){
      if( navigator.geolocation ){
         // Call getCurrentPosition with success and failure callbacks
         navigator.geolocation.getCurrentPosition( success, fail );
      }
      else{
         alert("Sorry, your browser does not support geolocation services.");
      }
    }

    function success(position){

     let userLongitude = position.coords.longitude;
     let userLatitude  = position.coords.latitude;

      // Initialize the platform object
      var platform = new H.service.Platform({
        'apikey': 'qzywSaIg3uRMzvxu88ZvqAL0Cd4EBjAVRGIoqjDZfvk'
      });

      var maptypes = platform.createDefaultLayers();

      // Initialize the map at user's coordinates
      var map = new H.Map(
        document.getElementById('mapContainer'),
        maptypes.raster.normal.mapnight, //maptypes.vector.normal.map
        {
          zoom: 15,
          center: { lng: userLongitude, lat: userLatitude }
        }
      );

      window.addEventListener('resize', () => 
        map.getViewPort().resize()
      );

      var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
     
      var ui = H.ui.UI.createDefault(map, defaultLayers);
    }

    function fail(){
      alert("couldn't obtain location");
    }

    </script>

  </head>

  <body style="padding: 0; margin: 0;" onload="initGeolocation()" >
    <div style="width: 100vw; height: 100vh" id="mapContainer"></div>
  </body>

</html>
